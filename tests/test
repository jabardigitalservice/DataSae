import os, io, gspread, json
from minio import Minio
from oauth2client.service_account import ServiceAccountCredentials

#os.system("rm -rfv /home/ubuntu/airflow/logs/*")

def is_editable () :
    scope = ['https://spreadsheets.google.com/feeds',
             'https://www.googleapis.com/auth/drive']

    # minio = Minio(
    #     's3.coredatajds.id',
    #     access_key='miniojdscoredata',
    #     secret_key='CnVqWLXN6CgZh4cCqcy2DRmhnQhdTEo7X7',
    #     secure=True,
    # )

    # data = minio.get_object(bucket_name='dwhhistoryupload', object_name='users/jds-riska-googlesheet-reader.json')
    # creds = json.load(io.BytesIO(data.data))

    credentials = ServiceAccountCredentials.from_json_keyfile_name(filename="C:/Users/riska/Documents/credential/jds-riska-googlesheet-reader.json", scopes=scope)
    gc = gspread.authorize(credentials)

    gsheet = gc.open_by_key('1gKdeqgMdIyerq-jIHXNIUS7B1-dyZKVQLOnwq-3UHKo')
    spreadsheets = gsheet.worksheet('EDIT')
    panjang = len(spreadsheets.acell('A1').value)
    # try :
    #     spreadsheets2 = get_credential_sheet_global('1gKdeqgMdIyerq-jIHXNIUS7B1-dyZKVQLOnwq-3UHKo', 'EDIT')

    #     print(spreadsheets2[0][0])
    #     return len(spreadsheets2[0][0])
    # except :
    #     return 0

is_editable()